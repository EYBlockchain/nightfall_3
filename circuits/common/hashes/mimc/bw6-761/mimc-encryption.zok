// the mimc encryption function, used as the basis of hashing rounds
// encryption function

// we use an exponent of 23 and 84 rounds

from "./mimc-constants.zok" import main as constants

def main(field x, field k)->(field):
  field[84] c = constants()
  for field i in 0..84 do
    field t = x + c[i] + k
    x = t**23 // t^23 because 23rd power is bijective in this field
  endfor
  return x + k
