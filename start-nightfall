#! /bin/bash
docker-compose down --remove-orphans

VOLUME_LIST=$(docker volume ls -q)

# if-else block checks - volume exist and then removes it.
if [[ $(echo $VOLUME_LIST | grep nightfall_3_timber-database-volume) ]]; then
  docker volume rm nightfall_3_timber-database-volume
fi

if [[ $(echo $VOLUME_LIST | grep nightfall_3_mongodb) ]]; then
  docker volume rm nightfall_3_mongodb
fi

if [[ $(echo $VOLUME_LIST | grep nightfall_3_build) ]]; then
  docker volume rm nightfall_3_build
fi

DIR=./common-files/node_modules
if [[ -d "$DIR" ]]; then
  rm -dr common-files/node_modules
fi

docker-compose up -d deployer
docker-compose up
