// SPDX-License-Identifier: CC0-1.0
// This is adapted from https://github.com/Loopring/
// but converted for our specific 2-input hash variety
// We are grateful for the work done by Loopring.
pragma solidity ^0.8.0;

library Poseidon
{
    function poseidon(uint256 t1, uint256 t2) public pure returns (uint256 t0){
        assembly ("memory-safe") {   
            let q:= 21888242871839275222246405745257275088548364400416034343698204186575808495617         
            function mix(_t0,_t1, _t2) -> nt0, nt1, nt2 {
                nt0 := addmod(addmod(
                    mulmod(_t0, 7511745149465107256748700652201246547602992235352608707588321460060273774987, 21888242871839275222246405745257275088548364400416034343698204186575808495617), 
                    mulmod(_t1, 10370080108974718697676803824769673834027675643658433702224577712625900127200, 21888242871839275222246405745257275088548364400416034343698204186575808495617), 21888242871839275222246405745257275088548364400416034343698204186575808495617), 
                    mulmod(_t2, 19705173408229649878903981084052839426532978878058043055305024233888854471533, 21888242871839275222246405745257275088548364400416034343698204186575808495617), 21888242871839275222246405745257275088548364400416034343698204186575808495617)
                nt1 := addmod(addmod(
                    mulmod(_t0, 18732019378264290557468133440468564866454307626475683536618613112504878618481, 21888242871839275222246405745257275088548364400416034343698204186575808495617), 
                    mulmod(_t1, 20870176810702568768751421378473869562658540583882454726129544628203806653987, 21888242871839275222246405745257275088548364400416034343698204186575808495617), 21888242871839275222246405745257275088548364400416034343698204186575808495617), 
                    mulmod(_t2, 7266061498423634438633389053804536045105766754026813321943009179476902321146, 21888242871839275222246405745257275088548364400416034343698204186575808495617), 21888242871839275222246405745257275088548364400416034343698204186575808495617)
                nt2 := addmod(addmod(
                    mulmod(_t0, 9131299761947733513298312097611845208338517739621853568979632113419485819303, 21888242871839275222246405745257275088548364400416034343698204186575808495617), 
                    mulmod(_t1, 10595341252162738537912664445405114076324478519622938027420701542910180337937, 21888242871839275222246405745257275088548364400416034343698204186575808495617), 21888242871839275222246405745257275088548364400416034343698204186575808495617), 
                    mulmod(_t2, 11597556804922396090267472882856054602429588299176362916247939723151043581408, 21888242871839275222246405745257275088548364400416034343698204186575808495617), 21888242871839275222246405745257275088548364400416034343698204186575808495617)
            }   
            // round 0
            t0 := addmod(t0, 6745197990210204598374042828761989596302876299545964402857411729872131034734, q)
            t1 := addmod(t1, 426281677759936592021316809065178817848084678679510574715894138690250139748, q)
            t2 := addmod(t2, 4014188762916583598888942667424965430287497824629657219807941460227372577781, q)
            let t00 := mulmod(t0, t0, q)
            let t11 := mulmod(t1, t1, q)
            let t22 := mulmod(t2, t2, q)
            t0, t1, t2 := mix(
                mulmod(t0, mulmod(t00, t00, q),q),
                mulmod(t1, mulmod(t11, t11, q),q), 
                mulmod(t2, mulmod(t22, t22, q),q))
            // round 1
            t0 := addmod(t0, 21328925083209914769191926116470334003273872494252651254811226518870906634704, q)
            t1 := addmod(t1, 19525217621804205041825319248827370085205895195618474548469181956339322154226, q)
            t2 := addmod(t2, 1402547928439424661186498190603111095981986484908825517071607587179649375482, q)
            t00 := mulmod(t0, t0, q)
            t11 := mulmod(t1, t1, q)
            t22 := mulmod(t2, t2, q)
            t0, t1, t2 := mix(
                mulmod(t0, mulmod(t00, t00, q),q),
                mulmod(t1, mulmod(t11, t11, q),q), 
                mulmod(t2, mulmod(t22, t22, q),q))
            // round 2
            t0 := addmod(t0, 18320863691943690091503704046057443633081959680694199244583676572077409194605, q)
            t1 := addmod(t1, 17709820605501892134371743295301255810542620360751268064484461849423726103416, q)
            t2 := addmod(t2, 15970119011175710804034336110979394557344217932580634635707518729185096681010, q)
            t00 := mulmod(t0, t0, q)
            t11 := mulmod(t1, t1, q)
            t22 := mulmod(t2, t2, q)
            t0, t1, t2 := mix(
                mulmod(t0, mulmod(t00, t00, q),q),
                mulmod(t1, mulmod(t11, t11, q),q), 
                mulmod(t2, mulmod(t22, t22, q),q))

            // round 3
            t0 := addmod(t0, 9818625905832534778628436765635714771300533913823445439412501514317783880744, q)
            t1 := addmod(t1, 6235167673500273618358172865171408902079591030551453531218774338170981503478, q)
            t2 := addmod(t2, 12575685815457815780909564540589853169226710664203625668068862277336357031324, q)
            t00 := mulmod(t0, t0, q)
            t11 := mulmod(t1, t1, q)
            t22 := mulmod(t2, t2, q)
            t0, t1, t2 := mix(
                mulmod(t0, mulmod(t00, t00, q),q),
                mulmod(t1, mulmod(t11, t11, q),q), 
                mulmod(t2, mulmod(t22, t22, q),q))
            // round 4
            t0 := addmod(t0, 7381963244739421891665696965695211188125933529845348367882277882370864309593, q)
            t1 := addmod(t1, 14214782117460029685087903971105962785460806586237411939435376993762368956406, q)
            t2 := addmod(t2, 13382692957873425730537487257409819532582973556007555550953772737680185788165, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 5
            t0 := addmod(t0, 2203881792421502412097043743980777162333765109810562102330023625047867378813, q)
            t1 := addmod(t1, 2916799379096386059941979057020673941967403377243798575982519638429287573544, q)
            t2 := addmod(t2, 4341714036313630002881786446132415875360643644216758539961571543427269293497, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 6
            t0 := addmod(t0, 2340590164268886572738332390117165591168622939528604352383836760095320678310, q)
            t1 := addmod(t1, 5222233506067684445011741833180208249846813936652202885155168684515636170204, q)
            t2 := addmod(t2, 7963328565263035669460582454204125526132426321764384712313576357234706922961, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 7
            t0 := addmod(t0, 1394121618978136816716817287892553782094854454366447781505650417569234586889, q)
            t1 := addmod(t1, 20251767894547536128245030306810919879363877532719496013176573522769484883301, q)
            t2 := addmod(t2, 141695147295366035069589946372747683366709960920818122842195372849143476473, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 8
            t0 := addmod(t0, 15919677773886738212551540894030218900525794162097204800782557234189587084981, q)
            t1 := addmod(t1, 2616624285043480955310772600732442182691089413248613225596630696960447611520, q)
            t2 := addmod(t2, 4740655602437503003625476760295930165628853341577914460831224100471301981787, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 9
            t0 := addmod(t0, 19201590924623513311141753466125212569043677014481753075022686585593991810752, q)
            t1 := addmod(t1, 12116486795864712158501385780203500958268173542001460756053597574143933465696, q)
            t2 := addmod(t2, 8481222075475748672358154589993007112877289817336436741649507712124418867136, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 10
            t0 := addmod(t0, 5181207870440376967537721398591028675236553829547043817076573656878024336014, q)
            t1 := addmod(t1, 1576305643467537308202593927724028147293702201461402534316403041563704263752, q)
            t2 := addmod(t2, 2555752030748925341265856133642532487884589978209403118872788051695546807407, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 11
            t0 := addmod(t0, 18840924862590752659304250828416640310422888056457367520753407434927494649454, q)
            t1 := addmod(t1, 14593453114436356872569019099482380600010961031449147888385564231161572479535, q)
            t2 := addmod(t2, 20826991704411880672028799007667199259549645488279985687894219600551387252871, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 12
            t0 := addmod(t0, 9159011389589751902277217485643457078922343616356921337993871236707687166408, q)
            t1 := addmod(t1, 5605846325255071220412087261490782205304876403716989785167758520729893194481, q)
            t2 := addmod(t2, 1148784255964739709393622058074925404369763692117037208398835319441214134867, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 13
            t0 := addmod(t0, 20945896491956417459309978192328611958993484165135279604807006821513499894540, q)
            t1 := addmod(t1, 229312996389666104692157009189660162223783309871515463857687414818018508814, q)
            t2 := addmod(t2, 21184391300727296923488439338697060571987191396173649012875080956309403646776, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 14
            t0 := addmod(t0, 21853424399738097885762888601689700621597911601971608617330124755808946442758, q)
            t1 := addmod(t1, 12776298811140222029408960445729157525018582422120161448937390282915768616621, q)
            t2 := addmod(t2, 7556638921712565671493830639474905252516049452878366640087648712509680826732, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 15
            t0 := addmod(t0, 19042212131548710076857572964084011858520620377048961573689299061399932349935, q)
            t1 := addmod(t1, 12871359356889933725034558434803294882039795794349132643274844130484166679697, q)
            t2 := addmod(t2, 3313271555224009399457959221795880655466141771467177849716499564904543504032, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 16
            t0 := addmod(t0, 15080780006046305940429266707255063673138269243146576829483541808378091931472, q)
            t1 := addmod(t1, 21300668809180077730195066774916591829321297484129506780637389508430384679582, q)
            t2 := addmod(t2, 20480395468049323836126447690964858840772494303543046543729776750771407319822, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 17
            t0 := addmod(t0, 10034492246236387932307199011778078115444704411143703430822959320969550003883, q)
            t1 := addmod(t1, 19584962776865783763416938001503258436032522042569001300175637333222729790225, q)
            t2 := addmod(t2, 20155726818439649091211122042505326538030503429443841583127932647435472711802, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 18
            t0 := addmod(t0, 13313554736139368941495919643765094930693458639277286513236143495391474916777, q)
            t1 := addmod(t1, 14606609055603079181113315307204024259649959674048912770003912154260692161833, q)
            t2 := addmod(t2, 5563317320536360357019805881367133322562055054443943486481491020841431450882, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 19
            t0 := addmod(t0, 10535419877021741166931390532371024954143141727751832596925779759801808223060, q)
            t1 := addmod(t1, 12025323200952647772051708095132262602424463606315130667435888188024371598063, q)
            t2 := addmod(t2, 2906495834492762782415522961458044920178260121151056598901462871824771097354, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 20
            t0 := addmod(t0, 19131970618309428864375891649512521128588657129006772405220584460225143887876, q)
            t1 := addmod(t1, 8896386073442729425831367074375892129571226824899294414632856215758860965449, q)
            t2 := addmod(t2, 7748212315898910829925509969895667732958278025359537472413515465768989125274, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 21
            t0 := addmod(t0, 422974903473869924285294686399247660575841594104291551918957116218939002865, q)
            t1 := addmod(t1, 6398251826151191010634405259351528880538837895394722626439957170031528482771, q)
            t2 := addmod(t2, 18978082967849498068717608127246258727629855559346799025101476822814831852169, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 22
            t0 := addmod(t0, 19150742296744826773994641927898928595714611370355487304294875666791554590142, q)
            t1 := addmod(t1, 12896891575271590393203506752066427004153880610948642373943666975402674068209, q)
            t2 := addmod(t2, 9546270356416926575977159110423162512143435321217584886616658624852959369669, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 23
            t0 := addmod(t0, 2159256158967802519099187112783460402410585039950369442740637803310736339200, q)
            t1 := addmod(t1, 8911064487437952102278704807713767893452045491852457406400757953039127292263, q)
            t2 := addmod(t2, 745203718271072817124702263707270113474103371777640557877379939715613501668, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 24
            t0 := addmod(t0, 19313999467876585876087962875809436559985619524211587308123441305315685710594, q)
            t1 := addmod(t1, 13254105126478921521101199309550428567648131468564858698707378705299481802310, q)
            t2 := addmod(t2, 1842081783060652110083740461228060164332599013503094142244413855982571335453, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 25
            t0 := addmod(t0, 9630707582521938235113899367442877106957117302212260601089037887382200262598, q)
            t1 := addmod(t1, 5066637850921463603001689152130702510691309665971848984551789224031532240292, q)
            t2 := addmod(t2, 4222575506342961001052323857466868245596202202118237252286417317084494678062, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 26
            t0 := addmod(t0, 2919565560395273474653456663643621058897649501626354982855207508310069954086, q)
            t1 := addmod(t1, 6828792324689892364977311977277548750189770865063718432946006481461319858171, q)
            t2 := addmod(t2, 2245543836264212411244499299744964607957732316191654500700776604707526766099, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 27
            t0 := addmod(t0, 19602444885919216544870739287153239096493385668743835386720501338355679311704, q)
            t1 := addmod(t1, 8239538512351936341605373169291864076963368674911219628966947078336484944367, q)
            t2 := addmod(t2, 15053013456316196458870481299866861595818749671771356646798978105863499965417, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 28
            t0 := addmod(t0, 7173615418515925804810790963571435428017065786053377450925733428353831789901, q)
            t1 := addmod(t1, 8239211677777829016346247446855147819062679124993100113886842075069166957042, q)
            t2 := addmod(t2, 15330855478780269194281285878526984092296288422420009233557393252489043181621, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 29
            t0 := addmod(t0, 10014883178425964324400942419088813432808659204697623248101862794157084619079, q)
            t1 := addmod(t1, 14014440630268834826103915635277409547403899966106389064645466381170788813506, q)
            t2 := addmod(t2, 3580284508947993352601712737893796312152276667249521401778537893620670305946, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 30
            t0 := addmod(t0, 2559754020964039399020874042785294258009596917335212876725104742182177996988, q)
            t1 := addmod(t1, 14898657953331064524657146359621913343900897440154577299309964768812788279359, q)
            t2 := addmod(t2, 2094037260225570753385567402013028115218264157081728958845544426054943497065, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 31
            t0 := addmod(t0, 18051086536715129874440142649831636862614413764019212222493256578581754875930, q)
            t1 := addmod(t1, 21680659279808524976004872421382255670910633119979692059689680820959727969489, q)
            t2 := addmod(t2, 13950668739013333802529221454188102772764935019081479852094403697438884885176, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 32
            t0 := addmod(t0, 9703845704528288130475698300068368924202959408694460208903346143576482802458, q)
            t1 := addmod(t1, 12064310080154762977097567536495874701200266107682637369509532768346427148165, q)
            t2 := addmod(t2, 16970760937630487134309762150133050221647250855182482010338640862111040175223, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 33
            t0 := addmod(t0, 9790997389841527686594908620011261506072956332346095631818178387333642218087, q)
            t1 := addmod(t1, 16314772317774781682315680698375079500119933343877658265473913556101283387175, q)
            t2 := addmod(t2, 82044870826814863425230825851780076663078706675282523830353041968943811739, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 34
            t0 := addmod(t0, 21696416499108261787701615667919260888528264686979598953977501999747075085778, q)
            t1 := addmod(t1, 327771579314982889069767086599893095509690747425186236545716715062234528958, q)
            t2 := addmod(t2, 4606746338794869835346679399457321301521448510419912225455957310754258695442, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 35
            t0 := addmod(t0, 64499140292086295251085369317820027058256893294990556166497635237544139149, q)
            t1 := addmod(t1, 10455028514626281809317431738697215395754892241565963900707779591201786416553, q)
            t2 := addmod(t2, 10421411526406559029881814534127830959833724368842872558146891658647152404488, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 36
            t0 := addmod(t0, 18848084335930758908929996602136129516563864917028006334090900573158639401697, q)
            t1 := addmod(t1, 13844582069112758573505569452838731733665881813247931940917033313637916625267, q)
            t2 := addmod(t2, 13488838454403536473492810836925746129625931018303120152441617863324950564617, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 37
            t0 := addmod(t0, 15742141787658576773362201234656079648895020623294182888893044264221895077688, q)
            t1 := addmod(t1, 6756884846734501741323584200608866954194124526254904154220230538416015199997, q)
            t2 := addmod(t2, 7860026400080412708388991924996537435137213401947704476935669541906823414404, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 38
            t0 := addmod(t0, 7871040688194276447149361970364037034145427598711982334898258974993423182255, q)
            t1 := addmod(t1, 20758972836260983284101736686981180669442461217558708348216227791678564394086, q)
            t2 := addmod(t2, 21723241881201839361054939276225528403036494340235482225557493179929400043949, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 39
            t0 := addmod(t0, 19428469330241922173653014973246050805326196062205770999171646238586440011910, q)
            t1 := addmod(t1, 7969200143746252148180468265998213908636952110398450526104077406933642389443, q)
            t2 := addmod(t2, 10950417916542216146808986264475443189195561844878185034086477052349738113024, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 40
            t0 := addmod(t0, 18149233917533571579549129116652755182249709970669448788972210488823719849654, q)
            t1 := addmod(t1, 3729796741814967444466779622727009306670204996071028061336690366291718751463, q)
            t2 := addmod(t2, 5172504399789702452458550583224415301790558941194337190035441508103183388987, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 41
            t0 := addmod(t0, 6686473297578275808822003704722284278892335730899287687997898239052863590235, q)
            t1 := addmod(t1, 19426913098142877404613120616123695099909113097119499573837343516470853338513, q)
            t2 := addmod(t2, 5120337081764243150760446206763109494847464512045895114970710519826059751800, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 42
            t0 := addmod(t0, 5055737465570446530938379301905385631528718027725177854815404507095601126720, q)
            t1 := addmod(t1, 14235578612970484492268974539959119923625505766550088220840324058885914976980, q)
            t2 := addmod(t2, 653592517890187950103239281291172267359747551606210609563961204572842639923, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 43
            t0 := addmod(t0, 5507360526092411682502736946959369987101940689834541471605074817375175870579, q)
            t1 := addmod(t1, 7864202866011437199771472205361912625244234597659755013419363091895334445453, q)
            t2 := addmod(t2, 21294659996736305811805196472076519801392453844037698272479731199885739891648, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 44
            t0 := addmod(t0, 13767183507040326119772335839274719411331242166231012705169069242737428254651, q)
            t1 := addmod(t1, 810181532076738148308457416289197585577119693706380535394811298325092337781, q)
            t2 := addmod(t2, 14232321930654703053193240133923161848171310212544136614525040874814292190478, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 45
            t0 := addmod(t0, 16796904728299128263054838299534612533844352058851230375569421467352578781209, q)
            t1 := addmod(t1, 16256310366973209550759123431979563367001604350120872788217761535379268327259, q)
            t2 := addmod(t2, 19791658638819031543640174069980007021961272701723090073894685478509001321817, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 46
            t0 := addmod(t0, 7046232469803978873754056165670086532908888046886780200907660308846356865119, q)
            t1 := addmod(t1, 16001732848952745747636754668380555263330934909183814105655567108556497219752, q)
            t2 := addmod(t2, 9737276123084413897604802930591512772593843242069849260396983774140735981896, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 47
            t0 := addmod(t0, 11410895086919039954381533622971292904413121053792570364694836768885182251535, q)
            t1 := addmod(t1, 19098362474249267294548762387533474746422711206129028436248281690105483603471, q)
            t2 := addmod(t2, 11013788190750472643548844759298623898218957233582881400726340624764440203586, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 48
            t0 := addmod(t0, 2206958256327295151076063922661677909471794458896944583339625762978736821035, q)
            t1 := addmod(t1, 7171889270225471948987523104033632910444398328090760036609063776968837717795, q)
            t2 := addmod(t2, 2510237900514902891152324520472140114359583819338640775472608119384714834368, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 49
            t0 := addmod(t0, 8825275525296082671615660088137472022727508654813239986303576303490504107418, q)
            t1 := addmod(t1, 1481125575303576470988538039195271612778457110700618040436600537924912146613, q)
            t2 := addmod(t2, 16268684562967416784133317570130804847322980788316762518215429249893668424280, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 50
            t0 := addmod(t0, 4681491452239189664806745521067158092729838954919425311759965958272644506354, q)
            t1 := addmod(t1, 3131438137839074317765338377823608627360421824842227925080193892542578675835, q)
            t2 := addmod(t2, 7930402370812046914611776451748034256998580373012248216998696754202474945793, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 51
            t0 := addmod(t0, 8973151117361309058790078507956716669068786070949641445408234962176963060145, q)
            t1 := addmod(t1, 10223139291409280771165469989652431067575076252562753663259473331031932716923, q)
            t2 := addmod(t2, 2232089286698717316374057160056566551249777684520809735680538268209217819725, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 52
            t0 := addmod(t0, 16930089744400890347392540468934821520000065594669279286854302439710657571308, q)
            t1 := addmod(t1, 21739597952486540111798430281275997558482064077591840966152905690279247146674, q)
            t2 := addmod(t2, 7508315029150148468008716674010060103310093296969466203204862163743615534994, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 53
            t0 := addmod(t0, 11418894863682894988747041469969889669847284797234703818032750410328384432224, q)
            t1 := addmod(t1, 10895338268862022698088163806301557188640023613155321294365781481663489837917, q)
            t2 := addmod(t2, 18644184384117747990653304688839904082421784959872380449968500304556054962449, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 54
            t0 := addmod(t0, 7414443845282852488299349772251184564170443662081877445177167932875038836497, q)
            t1 := addmod(t1, 5391299369598751507276083947272874512197023231529277107201098701900193273851, q)
            t2 := addmod(t2, 10329906873896253554985208009869159014028187242848161393978194008068001342262, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 55
            t0 := addmod(t0, 4711719500416619550464783480084256452493890461073147512131129596065578741786, q)
            t1 := addmod(t1, 11943219201565014805519989716407790139241726526989183705078747065985453201504, q)
            t2 := addmod(t2, 4298705349772984837150885571712355513879480272326239023123910904259614053334, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 56
            t0 := addmod(t0, 9999044003322463509208400801275356671266978396985433172455084837770460579627, q)
            t1 := addmod(t1, 4908416131442887573991189028182614782884545304889259793974797565686968097291, q)
            t2 := addmod(t2, 11963412684806827200577486696316210731159599844307091475104710684559519773777, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 57
            t0 := addmod(t0, 20129916000261129180023520480843084814481184380399868943565043864970719708502, q)
            t1 := addmod(t1, 12884788430473747619080473633364244616344003003135883061507342348586143092592, q)
            t2 := addmod(t2, 20286808211545908191036106582330883564479538831989852602050135926112143921015, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 58
            t0 := addmod(t0, 16282045180030846845043407450751207026423331632332114205316676731302016331498, q)
            t1 := addmod(t1, 4332932669439410887701725251009073017227450696965904037736403407953448682093, q)
            t2 := addmod(t2, 11105712698773407689561953778861118250080830258196150686012791790342360778288, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 59
            t0 := addmod(t0, 21853934471586954540926699232107176721894655187276984175226220218852955976831, q)
            t1 := addmod(t1, 9807888223112768841912392164376763820266226276821186661925633831143729724792, q)
            t2 := addmod(t2, 13411808896854134882869416756427789378942943805153730705795307450368858622668, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 60
            t0 := addmod(t0, 17906847067500673080192335286161014930416613104209700445088168479205894040011, q)
            t1 := addmod(t1, 14554387648466176616800733804942239711702169161888492380425023505790070369632, q)
            t2 := addmod(t2, 4264116751358967409634966292436919795665643055548061693088119780787376143967, q)
            t00 := mulmod(t0, t0, q)
            t0, t1, t2 := mix(mulmod(t0, mulmod(t00, t00, q),q), t1, t2)

            // round 61
            t0 := addmod(t0, 2401104597023440271473786738539405349187326308074330930748109868990675625380, q)
            t1 := addmod(t1, 12251645483867233248963286274239998200789646392205783056343767189806123148785, q)
            t2 := addmod(t2, 15331181254680049984374210433775713530849624954688899814297733641575188164316, q)
            t00 := mulmod(t0, t0, q)
            t11 := mulmod(t1, t1, q)
            t22 := mulmod(t2, t2, q)
            t0, t1, t2 := mix(
                mulmod(t0, mulmod(t00, t00, q),q),
                mulmod(t1, mulmod(t11, t11, q),q), 
                mulmod(t2, mulmod(t22, t22, q),q))
            // round 62
            t0 := addmod(t0, 13108834590369183125338853868477110922788848506677889928217413952560148766472, q)
            t1 := addmod(t1, 6843160824078397950058285123048455551935389277899379615286104657075620692224, q)
            t2 := addmod(t2, 10151103286206275742153883485231683504642432930275602063393479013696349676320, q)
            t00 := mulmod(t0, t0, q)
            t11 := mulmod(t1, t1, q)
            t22 := mulmod(t2, t2, q)
            t0, t1, t2 := mix(
                mulmod(t0, mulmod(t00, t00, q),q),
                mulmod(t1, mulmod(t11, t11, q),q), 
                mulmod(t2, mulmod(t22, t22, q),q))
            // round 63
            t0 := addmod(t0, 7074320081443088514060123546121507442501369977071685257650287261047855962224, q)
            t1 := addmod(t1, 11413928794424774638606755585641504971720734248726394295158115188173278890938, q)
            t2 := addmod(t2, 7312756097842145322667451519888915975561412209738441762091369106604423801080, q)
            t00 := mulmod(t0, t0, q)
            t11 := mulmod(t1, t1, q)
            t22 := mulmod(t2, t2, q)
            t0, t1, t2 := mix(
                mulmod(t0, mulmod(t00, t00, q),q),
                mulmod(t1, mulmod(t11, t11, q),q), 
                mulmod(t2, mulmod(t22, t22, q),q))
            // round 64
            t0 := addmod(t0, 7181677521425162567568557182629489303281861794357882492140051324529826589361, q)
            t1 := addmod(t1, 15123155547166304758320442783720138372005699143801247333941013553002921430306, q)
            t2 := addmod(t2, 13409242754315411433193860530743374419854094495153957441316635981078068351329, q)
            t00 := mulmod(t0, t0, q)
            t11 := mulmod(t1, t1, q)
            t22 := mulmod(t2, t2, q)
        
            t0 := addmod(
                    addmod(
                    mulmod(mulmod(t0, 
                        mulmod(t00, t00, q),q), 7511745149465107256748700652201246547602992235352608707588321460060273774987, q), 
                    mulmod(mulmod(t1, 
                        mulmod(t11, t11, q),q), 10370080108974718697676803824769673834027675643658433702224577712625900127200, q), q),
                        mulmod(mulmod(t2, 
                            mulmod(t22, t22, q),q), 19705173408229649878903981084052839426532978878058043055305024233888854471533, q), q)

        }
        return t0;
    }
}
